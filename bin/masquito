#!/usr/bin/env ruby

require 'rubygems'
require 'masquito'

abort 'Works only on Mac OS X' if RUBY_PLATFORM !~ /darwin/

command = ARGV[0]
subcommand = ARGV[1]
filename = File.basename(__FILE__)

case command
when 'start'
  Masquito::DNS.new
when /daemon|resolver/
  require 'masquito/install'
  options = %w(install uninstall)
  unless options.include?(subcommand)
    abort "Usage: #{filename} #{command} #{options.join(' | ')}"
  end
  Masquito.send("#{command}_#{subcommand}")
when 'version'
  require 'masquito/version'
  puts Masquito::VERSION
else
  puts "Usage: #{filename} #{%w(daemon resolver version).join(' | ')}"
end
